[2021-12-12 11:19:16,267] [WARNING] [runner.py:122:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2021-12-12 11:19:17,225] [INFO] [runner.py:360:main] cmd = /opt/conda/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=24753 pretrain_glm.py --block-lm --task-mask --bert-prob 0.5 --gap-sentence-prob 0.3 --avg-block-length 3 --gpt-min-ratio 0.25 --block-mask-prob 0.1 --short-seq-prob 0.02 --experiment-name blocklm-10b-ssm --model-parallel-size 1 --num-layers 48 --hidden-size 4096 --num-attention-heads 64 --seq-length 513 --max-sequence-length 1025 --save /dataset/fd5061f6/english_data/checkpoints --load /dataset/fd5061f6/english_data/checkpoints/blocklm-10b-512 --old-checkpoint --log-interval 50 --eval-interval 1000 --save-interval 2000 --train-iters 250000 --train-data wikipedia_ssm --resume-dataloader --filter-english --loader-scatter 32 --tokenizer-type GPT2BPETokenizer --tokenizer-model-type gpt2 --split 949,50,1 --distributed-backend nccl --lr-decay-style cosine --lr-decay-ratio 0.1 --lr-decay-iters 175000 --warmup 0.04 --checkpoint-activations --fp16 --deepspeed --deepspeed_config /dataset/fd5061f6/liuxiao/BlockLM-ssm/config/config_block_10B.json
[2021-12-12 11:19:17,916] [INFO] [launch.py:73:main] 0 NCCL_IB_DISABLE 0
[2021-12-12 11:19:17,916] [INFO] [launch.py:73:main] 0 NCCL_DEBUG info
[2021-12-12 11:19:17,916] [INFO] [launch.py:73:main] 0 NCCL_NET_GDR_LEVEL 2
[2021-12-12 11:19:17,916] [INFO] [launch.py:80:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2021-12-12 11:19:17,916] [INFO] [launch.py:86:main] nnodes=1, num_local_procs=8, node_rank=0
[2021-12-12 11:19:17,916] [INFO] [launch.py:101:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2021-12-12 11:19:17,916] [INFO] [launch.py:102:main] dist_world_size=8
[2021-12-12 11:19:17,916] [INFO] [launch.py:104:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
using world size: 8 and model-parallel size: 1 
> initializing model parallel with size 1
[2021-12-12 11:19:21,003] [WARNING] [config.py:79:_sanity_check] DeepSpeedConfig: cpu_offload is deprecated. Please use offload_optimizer.
[2021-12-12 11:19:21,005] [WARNING] [config.py:79:_sanity_check] DeepSpeedConfig: cpu_offload is deprecated. Please use offload_optimizer.
[2021-12-12 11:19:21,005] [WARNING] [config.py:79:_sanity_check] DeepSpeedConfig: cpu_offload is deprecated. Please use offload_optimizer.
[2021-12-12 11:19:21,005] [INFO] [checkpointing.py:734:_configure_using_config_file] {'partition_activations': False, 'contiguous_memory_optimization': False, 'cpu_checkpointing': False, 'number_checkpoints': None, 'synchronize_checkpoint_boundary': False, 'profile': False}
[2021-12-12 11:19:21,005] [INFO] [checkpointing.py:223:model_parallel_cuda_manual_seed] > initializing model parallel cuda seeds on global rank 0, model parallel rank 0, and data parallel rank 0 with model parallel seed: 3952 and data parallel seed: 1234
[2021-12-12 11:19:21,005] [WARNING] [config.py:79:_sanity_check] DeepSpeedConfig: cpu_offload is deprecated. Please use offload_optimizer.
[2021-12-12 11:19:21,007] [WARNING] [config.py:79:_sanity_check] DeepSpeedConfig: cpu_offload is deprecated. Please use offload_optimizer.
[2021-12-12 11:19:21,009] [WARNING] [config.py:79:_sanity_check] DeepSpeedConfig: cpu_offload is deprecated. Please use offload_optimizer.
[2021-12-12 11:19:21,010] [WARNING] [config.py:79:_sanity_check] DeepSpeedConfig: cpu_offload is deprecated. Please use offload_optimizer.
[2021-12-12 11:19:21,011] [WARNING] [config.py:79:_sanity_check] DeepSpeedConfig: cpu_offload is deprecated. Please use offload_optimizer.
[CommandToken(name='pad', token='<|endoftext|>', Id=50256), CommandToken(name='eos', token='<|endoftext|>', Id=50256), CommandToken(name='sop', token='<|startofpiece|>', Id=50257), CommandToken(name='eop', token='<|endofpiece|>', Id=50258), CommandToken(name='ENC', token='[CLS]', Id=50259), CommandToken(name='MASK', token='[MASK]', Id=50260), CommandToken(name='sep', token='[SEP]', Id=50261), CommandToken(name='unk', token='[UNK]', Id=50262), CommandToken(name='gMASK', token='[gMASK]', Id=50263), CommandToken(name='sMASK', token='[sMASK]', Id=50264), CommandToken(name='dBLOCK', token='[dBLOCK]', Id=50265)]
[CommandToken(name='pad', token='<|endoftext|>', Id=50256), CommandToken(name='eos', token='<|endoftext|>', Id=50256), CommandToken(name='sop', token='<|startofpiece|>', Id=50257), CommandToken(name='eop', token='<|endofpiece|>', Id=50258), CommandToken(name='ENC', token='[CLS]', Id=50259), CommandToken(name='MASK', token='[MASK]', Id=50260), CommandToken(name='sep', token='[SEP]', Id=50261), CommandToken(name='unk', token='[UNK]', Id=50262), CommandToken(name='gMASK', token='[gMASK]', Id=50263), CommandToken(name='sMASK', token='[sMASK]', Id=50264), CommandToken(name='dBLOCK', token='[dBLOCK]', Id=50265)]
[CommandToken(name='pad', token='<|endoftext|>', Id=50256), CommandToken(name='eos', token='<|endoftext|>', Id=50256), CommandToken(name='sop', token='<|startofpiece|>', Id=50257), CommandToken(name='eop', token='<|endofpiece|>', Id=50258), CommandToken(name='ENC', token='[CLS]', Id=50259), CommandToken(name='MASK', token='[MASK]', Id=50260), CommandToken(name='sep', token='[SEP]', Id=50261), CommandToken(name='unk', token='[UNK]', Id=50262), CommandToken(name='gMASK', token='[gMASK]', Id=50263), CommandToken(name='sMASK', token='[sMASK]', Id=50264), CommandToken(name='dBLOCK', token='[dBLOCK]', Id=50265)]
[CommandToken(name='pad', token='<|endoftext|>', Id=50256), CommandToken(name='eos', token='<|endoftext|>', Id=50256), CommandToken(name='sop', token='<|startofpiece|>', Id=50257), CommandToken(name='eop', token='<|endofpiece|>', Id=50258), CommandToken(name='ENC', token='[CLS]', Id=50259), CommandToken(name='MASK', token='[MASK]', Id=50260), CommandToken(name='sep', token='[SEP]', Id=50261), CommandToken(name='unk', token='[UNK]', Id=50262), CommandToken(name='gMASK', token='[gMASK]', Id=50263), CommandToken(name='sMASK', token='[sMASK]', Id=50264), CommandToken(name='dBLOCK', token='[dBLOCK]', Id=50265)]
[CommandToken(name='pad', token='<|endoftext|>', Id=50256), CommandToken(name='eos', token='<|endoftext|>', Id=50256), CommandToken(name='sop', token='<|startofpiece|>', Id=50257), CommandToken(name='eop', token='<|endofpiece|>', Id=50258), CommandToken(name='ENC', token='[CLS]', Id=50259), CommandToken(name='MASK', token='[MASK]', Id=50260), CommandToken(name='sep', token='[SEP]', Id=50261), CommandToken(name='unk', token='[UNK]', Id=50262), CommandToken(name='gMASK', token='[gMASK]', Id=50263), CommandToken(name='sMASK', token='[sMASK]', Id=50264), CommandToken(name='dBLOCK', token='[dBLOCK]', Id=50265)]
[CommandToken(name='pad', token='<|endoftext|>', Id=50256), CommandToken(name='eos', token='<|endoftext|>', Id=50256), CommandToken(name='sop', token='<|startofpiece|>', Id=50257), CommandToken(name='eop', token='<|endofpiece|>', Id=50258), CommandToken(name='ENC', token='[CLS]', Id=50259), CommandToken(name='MASK', token='[MASK]', Id=50260), CommandToken(name='sep', token='[SEP]', Id=50261), CommandToken(name='unk', token='[UNK]', Id=50262), CommandToken(name='gMASK', token='[gMASK]', Id=50263), CommandToken(name='sMASK', token='[sMASK]', Id=50264), CommandToken(name='dBLOCK', token='[dBLOCK]', Id=50265)]
[CommandToken(name='pad', token='<|endoftext|>', Id=50256), CommandToken(name='eos', token='<|endoftext|>', Id=50256), CommandToken(name='sop', token='<|startofpiece|>', Id=50257), CommandToken(name='eop', token='<|endofpiece|>', Id=50258), CommandToken(name='ENC', token='[CLS]', Id=50259), CommandToken(name='MASK', token='[MASK]', Id=50260), CommandToken(name='sep', token='[SEP]', Id=50261), CommandToken(name='unk', token='[UNK]', Id=50262), CommandToken(name='gMASK', token='[gMASK]', Id=50263), CommandToken(name='sMASK', token='[sMASK]', Id=50264), CommandToken(name='dBLOCK', token='[dBLOCK]', Id=50265)]
[CommandToken(name='pad', token='<|endoftext|>', Id=50256), CommandToken(name='eos', token='<|endoftext|>', Id=50256), CommandToken(name='sop', token='<|startofpiece|>', Id=50257), CommandToken(name='eop', token='<|endofpiece|>', Id=50258), CommandToken(name='ENC', token='[CLS]', Id=50259), CommandToken(name='MASK', token='[MASK]', Id=50260), CommandToken(name='sep', token='[SEP]', Id=50261), CommandToken(name='unk', token='[UNK]', Id=50262), CommandToken(name='gMASK', token='[gMASK]', Id=50263), CommandToken(name='sMASK', token='[sMASK]', Id=50264), CommandToken(name='dBLOCK', token='[dBLOCK]', Id=50265)]
> padded vocab (size: 50266) with 38 dummy tokens (new size: 50304)
prepare tokenizer done
configuring data
Creating scatter loader for dataset wikipedia_ssm
